---
title: Site Planning for a Network of Weather Stations in the Dominican Republic Using Zonal Statistics from Geospatial Sources, Multi-Criteria Selection, and Neighborhood Analysis
authors:
  - name: \parbox[t]{10cm}{\centering José-Ramón Martínez-Batlle \\ \orcidlink{0000-0001-9924-0327}}
    department: Facultad de Ciencias
    affiliation: Universidad Autónoma de Santo Domingo (UASD)
    location:  Santo Domingo, República Dominicana
    email: joseramon@geografiafisica.org
  - name: \parbox[t]{10cm}{\centering Michela Izzo Gioiosa \\ \orcidlink{0000-0003-4835-3967}}
    department: Directora Ejecutiva
    affiliation: Guakia Ambiente
    location:  Santo Domingo, República Dominicana
    email: michela.izzo@guakiambiente.org
abstract: |
  Many weather station networks lack sufficient representativeness, and their station density is often inadequate to capture spatial and climatic variability effectively. Optimal site selection is therefore essential to enhance spatial coverage and improve data quality. This study proposes a methodology for identifying optimal sites for a meteorological station network in the Dominican Republic, utilizing a multi-criteria decision-making framework based on the Analytic Hierarchy Process (AHP) and neighborhood analysis. Using the H3 library as a spatial indexing tool, zonal statistics were derived from geospatial variables, including seasonality, habitat heterogeneity, proximity to water bodies, slope, solar radiation, and elevation. Expert-defined weights were assigned to each variable based on their relative importance. Areas with high topographic and climatic variability were prioritized to maximize spatial representativeness. Results highlight thermal and precipitation seasonality, elevation, and solar radiation as the most influential variables, emphasizing the need to collect data in elevated areas with marked seasonality. Sites were evenly distributed across three density scenarios, ensuring robust climatic and topographic coverage while avoiding redundancy through proximity constraints to existing stations. The proposed network would provide essential data for meteorological and climatic research in the region. Future studies should assess the accessibility and feasibility of the selected sites and incorporate additional environmental variables into the framework.
keywords:
  - Weather stations networks
  - Optimal site selection
  - Spatial coverage
  - Multi-criteria decision-making
  - AHP
bibliography: references.bib
csl: apa.csl
# lang: en
output: rticles::arxiv_article
keep_tex: yes
editor_options: 
  chunk_output_type: console
always_allow_html: true
header-includes:
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
  \usepackage{orcidlink}
  \usepackage{float}
  \usepackage[all]{nowidow}
  \usepackage{xcolor}
  \usepackage{tabu}
  \newcommand{\beginsupplement}{
    \setcounter{table}{0}
    \renewcommand{\thetable}{S\arabic{table}}
    \renewcommand\tablename{Tabla}
    \setcounter{figure}{0}
    \renewcommand{\thefigure}{S\arabic{figure}}
    \renewcommand\figurename{Figura}
  }
  \usepackage[hidelinks]{hyperref}
  \usepackage{xurl}
  \usepackage[left]{lineno}
  \linenumbers
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  cache = FALSE, 
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  out.width = '100%',
  dpi = 300,
  fig.align = "center"
  )
# options(digits = 3)
options(knitr.duplicate.label = "allow")
raiz_supl_met <- 'suplemento'
figures <- 'figuras'
```

```{r, echo=F, include=F}
incluir_supl_al_final <- F
cargar_script_supl_met <- F
if(cargar_script_supl_met) {
  knitr::purl(paste0(raiz_supl_met, '.Rmd'))
  source(paste0(raiz_supl_met, '.R'))
}
```

```{r pkgs, echo=F, include=F, cache=F}
library(sf)
library(leaflet)
library(leaflet.extras)
library(mapview)
library(readODS)
library(readxl)
library(parzer)
library(fuzzyjoin)
library(raster)
library(psych)
library(kableExtra)
library(tidyverse)
library(ahpsurvey)
library(janitor)
library(patchwork)
library(viridis)
library(cowplot)
source('R/funciones.R')
estilo_kable <- function(df, titulo = '', cubre_anchura = T) {
  df %>% kable(format = 'html', escape = F, booktabs = T, digits = 2, caption = titulo) %>%
  kable_styling(bootstrap_options = c("hover", "condensed"), full_width = cubre_anchura)
}
```

```{r pkgsetings, echo=F, include=F}
set.seed(99)
# library(tidyverse)
theme_set(theme_bw()) 
# library(kableExtra)
options(knitr.kable.NA = '', knitr.table.format = 'latex')
```

```{r objects, echo=F, include=F, cache=T}
load('datos/r-image-ws-list.RData')
load('datos/r-image-site-selection.RData')
ruta_ez_gh <- 'https://raw.githubusercontent.com/geofis/zonal-statistics/'
ez_ver <- 'd7f79365168e688f0d78f521e53fbf2da19244ef/'
pais_url <- paste0(ruta_ez_gh, ez_ver, 'inst/extdata/dr.gpkg')
pais <- invisible(st_read(pais_url, optional = T, layer = 'pais', quiet = T))
st_geometry(pais) <- "geometry"
haiti <- st_read("datos/haiti.gpkg", quiet = TRUE)
lims_rd_orig <- st_bbox(pais)
rd_buffer <- 0.05
lims_rd_buffer <- ifelse(
  grepl('min', names(lims_rd_orig)),
  lims_rd_orig - rd_buffer,
  lims_rd_orig + rd_buffer)
names(lims_rd_buffer) <- names(lims_rd_orig)
```

# Introduction

Weather stations (WS) are essential for collecting accurate and up-to-date data on weather and climate in specific regions. The applications of the data collected by WS extend beyond meteorology and climatology, finding widespread use in fields such as engineering, agriculture, urban planning, and geography, among others [@design1976hydrological; @Marchi2019EvaluatingWV; @vanWilgen2016RisingTA; @Chung2018SpatialAO]. The data provided by these stations are instrumental in predicting extreme weather events, such as tropical storms, hurricanes, tornadoes, and droughts, enabling communities to prepare and respond effectively. Furthermore, WS data underpin numerous scientific studies on climate and climate change, helping to better understand atmospheric dynamics and their impacts on the planet, ultimately contributing to more informed and effective planning strategies [@world1996guia; @wmo2017guia; @wmo2017guide].

A robust WS network is crucial for making informed decisions across various domains and is fundamental for the well-being and safety of communities and the environment. Planning an adequate WS network is essential for effective land management. Previous studies, including those conducted in the Dominican Republic, reveal significant gaps in WS coverage in key areas and highlight the uneven spatial distribution and low density of existing networks, which likely affect the accuracy of collected data [@theochari2021hydrometeorological; @rojasbriceno2021; @frei2003designing; @proyecto2019pma].

Many countries have evaluated the design of their WS networks, sometimes revisiting and improving them multiple times, often with successful implementations [@frei2003designing]. Some have developed site selection protocols that align with general World Meteorological Organization (WMO) standards, adapting or extending them to meet the specific needs of their territories and intended applications [@rojasbriceno2021; @theochari2021hydrometeorological].

The Dominican Republic is highly vulnerable to the impacts of climate change, and an insufficient WS network exacerbates this vulnerability [@Le2019ClimateCA; @Lohmann2016ComparingVA; @Izzo2010ANC; @Roson2013AMF; @LincolnLenderking2020ClimateCA; @Mackay2017TheFO]. Improving and expanding the WS network requires investment in technology and infrastructure, as well as partnerships among government agencies, private entities, and research institutions [@proyecto2019pma]. However, to optimize the use of limited resources, it is critical to design, evaluate, and select network alternatives using weighted criteria.

Research on the design of weather station networks consistently identifies multi-criteria decision-making (MCDM) methods as ideal for this purpose [@thiriez1975multiple; @koksalan2011multiple; @encyclopedia3010006]. These methods leverage geospatial data and include public input spatially integrated into decision-making using Geographic Information Systems (GIS) [@rojasbriceno2021; @theochari2021hydrometeorological; @tekleyohannes2021; @chakhar2008spatial; @malczewski2004gis; @eastman1998multi]. Studies have demonstrated the effectiveness of traditional geostatistical techniques [@ali2018; @valipour2019], contemporary deep learning algorithms in combination with traditional methods [@safavi2021], and entropy-based approaches [@bertini2021]. Combining geospatial data (e.g., GIS and remote sensing) with multi-criteria analysis (MCA) that assigns relative weights to geographical criteria is particularly efficient for analyzing diverse variables [@rojasbriceno2021].

The Analytic Hierarchy Process (AHP), a well-established multi-criteria decision-making (MCDM) method, is widely used due to its simplicity, its ability to provide insights into the analyzed attributes, and its structured framework for incorporating expert input [@rojasbriceno2021]. Developed by Thomas Saaty in the 1970s [@saaty1977] and refined in subsequent decades [@saaty2001; @saaty2007], AHP is used to make decisions involving multiple criteria and alternatives. Traditionally applied in engineering, social sciences, economics, and business, AHP has recently been utilized effectively for selecting optimal WS sites in Peru [@rojasbriceno2021].

AHP involves breaking down a complex problem into a hierarchical structure of criteria and subcriteria, followed by pairwise comparisons to assign relative importance. The process includes identifying objectives and criteria, structuring them hierarchically, conducting pairwise comparisons, calculating priority values for criteria, and ranking alternatives based on aggregated priorities.

In this study, we integrate the Analytical Hierarchy Process (AHP) with geospatial and expert-driven data to systematically identify optimal sites for meteorological and climatic stations in the Dominican Republic. We prioritize key environmental and accessibility criteria to maximize spatial and resource efficiency while minimizing redundancy in existing networks. Additionally, we propose actionable scenarios for network expansion that align with international standards, offering solutions to address data gaps in poorly covered regions. Through this research, we advance geospatial methodologies and decision-support frameworks for meteorological infrastructure planning, with potential applications in broader climatological and environmental sciences.

# Materials and Methods

We applied a sequence of four interdependent steps to develop alternative designs for weather station (WS) networks, emphasizing the multi-criteria selection of sites prioritized for their deployment. First, we gathered data on the existing WS network through consultations (via forms and visits) with government agencies, including the Dominican National Meteorological Office (ONAMET, now the Dominican Institute of Meteorology, INDOMET) and the National Institute of Hydraulic Resources (INDRHI). These forms were created and managed using the Open Data Kit (ODK) platform [@hartung2010odk; @getodk2024]. We also consulted private entities managing WS networks. These efforts resulted in consolidated information on station locations, operational status, and other relevant attributes. This step ensured that the analysis was grounded in an accurate and comprehensive understanding of the current state of the WS network.


Subsequently, we implemented an Analytic Hierarchy Process (AHP) to select the optimal option among different alternatives using selection criteria weighted by individuals with expertise in the problem [@saaty2013]. The selected criteria were `r paste(as.vector(variables_eng), collapse = ', ')`. These eight criteria were chosen based on their relevance to the problem, supported by our expertise as well as previous studies and recommendations from the World Meteorological Organization [@rojasbriceno2021; @design1976hydrological].

We explicitly requested expert consultations, asking respondents to complete questionnaires electronically. After collecting the responses, we organized and recoded the data, then evaluated their consistency. We used only consistent responses to establish the criteria weights, which were subsequently applied to the available geographic information sources, including approximately [13,000 hexagons containing the corresponding multi-criteria information distributed across the Dominican Republic](https://geofis.github.io/zonal-statistics/README.html) [@jose_ramon_martinez_batlle_2022_7367180]. Afterwards, we created these hexagons using the H3 spatial index library from Uber and computed zonal statistics with Google Earth Engine (GEE) [@uber2024h3; @GORELICK201718]. Specifically, we employed the GEE Python API to process the data programmatically, using packages like `geemap` for map visualization and data handling [@google2023earthengine; @wu_geemap_2020]. Finally, we assigned each hexagon an aggregated priority category, choosing from four possible options: `r paste(paste(fuente_eng[1:length(fuente_eng)-1], collapse = ', '), 'and', last(fuente_eng))`.

We designed the questionnaires, processed the responses, and weighted the criteria of geographic information sources using programming languages. These tasks were performed in the R statistical programming environment with the following packages: `ahpsurvey`, `sf`, `raster`, `terra`, `ggplot2`, `tidyverse`, `kableExtra`, `spdep`, `units`, `knitr`, and `rmarkdown` [@cho2019ahpsurvey; @zhu2021kableextra; @xie2014implementing; @xie2020rmarkdown; @pebesma2016measurement; @rcoreteam2024r; @hadley2019welcome; @hijmans2023raster; @pebesma2023spatial; @pebesma2018simple; @hijmans2024terra]. We also used Python to automate the design of questionnaires and their integration with Google Forms via its API.

Subsequently, we used the AHP results as input for a constraint-based exclusion process. In this step, we carefully analyzed the hexagons to identify those located in areas where accessibility was limited or where proximity to water bodies posed challenges. Hexagons situated near or within water bodies were deemed unsuitable for hosting meteorological stations and were excluded from further consideration. This process ensured that only feasible locations remained for the next steps of the analysis.

Finally, we conducted a neighborhood analysis between existing and proposed stations to ensure spatial homogeneity and avoid redundancy. First, we generated optimized station locations using a custom algorithm based on convex hulls and distance maximization. This method iteratively selected points that maximized their distance from previously chosen points, ensuring an optimal spatial distribution aligned with the station density criteria recommended by the World Meteorological Organization [@design1976hydrological; @wmo2020guide]. Subsequently, we used continuous distance surfaces (e.g., rasters) as part of the neighborhood analysis to eliminate proposed stations that were too close to existing ones, thereby avoiding redundancy. Detailed methodological steps can be found in the [Supplementary Information](#infosupl).


# Results


```{r, echo=F}
consolidado_sf_for_map <- consolidado_sf %>% 
  mutate(entidad = gsub('ONAMET', 'INDOMET', entidad)) %>%
  mutate(Estado = factor(Estado)) %>% 
  filter(Nombre != 'RADIOSONDA')
consolidado_sf_for_map_indrhi <- consolidado_sf_for_map %>%
  filter(entidad == 'INDRHI')
ws_network_2022_indrhi_map <- consolidado_sf_for_map_indrhi %>% 
  country_map_ws(entity = "INDRHI") +
  theme(legend.position = "none")
consolidado_sf_for_map_indomet <- consolidado_sf_for_map %>%
  filter(entidad == 'INDOMET')
ws_network_2022_indomet_map <- consolidado_sf_for_map_indomet %>% 
  country_map_ws(entity = "INDOMET") +
  theme(legend.position = "none")
consolidado_sf_for_map_indomet_indrhi_act <- consolidado_sf_for_map %>%
  filter(entidad %in% c("INDOMET", "INDRHI"),
         Estado == 'activa o bueno') %>% 
  mutate(entidad = 'INDOMET & INDRHI (only active stations)')
ws_network_2022_indomet_indrhi_act_map <- consolidado_sf_for_map_indomet_indrhi_act %>%
  country_map_ws(entity = "INDOMET & INDRHI (only active stations)") +
  theme(legend.position = "none")
ws_network_2022_grid1 <- plot_grid(
  ws_network_2022_indomet_map,
  ws_network_2022_indrhi_map,
  ws_network_2022_indomet_indrhi_act_map#,
  # NULL,
  # ncol = 2, nrow = 2, align = "hv"
  )
ws_network_2022_map_legend <- get_legend(
  ws_network_2022_indrhi_map +
    theme(
      legend.position = "right",
      legend.text = element_text(size = 12),
      legend.title = element_text(size = 12),
      legend.key.size = unit(1, "cm"),
      legend.spacing = unit(0.25 * 1.5, "mm")
      ))
ws_network_2022_grid2 <- ws_network_2022_grid1 +
  draw_grob(ws_network_2022_map_legend, 0.6, 0, 1/3, 0.5)
jpeg(filename = paste0(figures, '/', 'ws_network_2022_grid2.jpg'),
     width = 3500, height = 2500, res = 350)
ws_network_2022_grid2
invisible(dev.off())
```

(Table&nbsp;\ref{tab:summaryindometindrhi} and Figure&nbsp;\ref{fig:ws_network_2022_grid2})

```{r ws_network_2022_grid2, echo=F, fig.cap='Weather station networks in the Dominican Republic for 2022, categorized by management entities: the Dominican Institute of Meteorology (INDOMET) and the National Institute of Hydraulic Resources (INDRHI). The maps illustrate the spatial distribution of stations by operational status, including "Active or Good," "Recoverable," and "Inactive or Not Reported." A combined map showcases only active stations from both entities to emphasize their geographic coverage'}
knitr::include_graphics(paste0(figures, "/", "ws_network_2022_grid2.jpg"))
```


```{r summaryindometindrhi, echo=F}
consolidado_sf %>%
  filter(tipo == "meteoclimática") %>%
  mutate(entidad = gsub('ONAMET', 'INDOMET', entidad)) %>% 
  mutate(Estado = recode(
    .x = Estado,
    "activa o bueno" = "Active or Good",
    "regular" = "Recoverable",
    "inactiva o no reportada" = "Inactive or Not Reported"
  )) %>% 
  filter(entidad %in% c("INDOMET", "INDRHI")) %>% 
  st_drop_geometry %>%
  select(`Owner` = entidad, Status = Estado) %>%
  group_by_all() %>% 
  count() %>% 
  pivot_wider(names_from = Status, values_from = n, values_fill = 0) %>% 
  adorn_totals(c('row', 'col')) %>% 
  estilo_kable(cubre_anchura = F, titulo = 'Summary of weather station status by owner (INDOMET and INDRHI) in the Dominican Republic for 2022, including the number of active or good, inactive or not reported, and recoverable stations, along with their total counts') %>% 
  column_spec(column = 2:5,
              width = c("7em", "7em", "13em", "7em", "7em"),
              latex_column_spec = 'r')
```



# Discussion


# Conflict of Interest Declaration {.unnumbered}

The authors declare that they have no conflict of interest related to the content of this article.

# Author Contributions

JM and MI conceptualized and designed the study. JM was responsible for data collection. JM and MI established the methodology and conducted the research. JM developed the software, and supervision was carried out by MI. Both validated the work. JM and MI were in charge of visualization and drafted the original manuscript.

# Data, Scripts, and Code Availability {.unnumbered}

The data supporting the findings of this study are openly available on Zenodo at \url{} []. The scripts used for data curation, analysis, and visualization are available in this section, as well as in the GitHub repository at \url{} and on Zenodo at \url{} [].


\newpage

# Supplementary Information {#suppinfo .unnumbered}


```{=tex}
\beginsupplement
```


```{r child=paste0(raiz_supl_met, '.Rmd'), eval=incluir_supl_al_final}
```

# References
